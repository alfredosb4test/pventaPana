function limpiar_datos_insert(){$("#tr_cantidad").hide(),$("#txt_cj_codigo").attr("value","").focus(),$("#text_nombre_prod").empty(),$prod_existente=0,$eq=-1}function key_buscar_producto(a,b){var c=a||window.event,d=c.charCode||c.keyCode;if(13==d){if($codigo=$(b).val(),""==$codigo)return void $("#text_nombre_prod").html('<div class="msg alerta_err">Ingrese un codigo.</div>');buscar_producto($codigo)}}function buscar_producto(a){return $id_sucursal=$("#lst_sucursales_admin_prod").val(),""==$id_sucursal?void $("#text_nombre_prod").html('<div class="msg alerta_err">Seleccione una Sucursal.</div>'):($prod_existente=0,$("#tr_cantidad").hide(),void $.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:"crud_pventas.php",data:"accion=producto_a_unidades_buscar&codigo="+a+"&id_sucursal="+$id_sucursal,beforeSend:function(){},success:function(b){var c=jQuery.parseJSON(b);if($codigo_unidades=c.codigo_unidades,$nombre_prod=c.nombre,$("#ajax_respuesta").empty(),"existe"==c.status){if($prod_existente=1,$cantidad_org=c.cantidad,0==$cantidad_org)return void $("#text_nombre_prod").html('<div class="msg alerta_err">Producto sin existencias.</div>');$nombre_codigo_unidades=c.nombre_codigo_unidades,$cantidad_total_unidades=c.cantidad_codigo_unidades,$prod_original='<div class="msg alerta_ok">'+$nombre_prod+"<strong> / Cantidad Actual ("+$cantidad_org+")</strong>",$prod_unidades=", convertirlo a unidades para <strong>"+$nombre_codigo_unidades+"</strong> <strong> / Cantidad Actual ("+c.cantidad_codigo_unidades+")</strong> </div>",$("#text_nombre_prod").html($prod_original+$prod_unidades),$("#text_nombre_prod").attr("id_prod",c.id),$("#text_nombre_prod").attr("id_codigo_unidades",c.id_codigo_unidades),$("#txt_cj_codigo").attr("value","").focus(),$("#select_cantidad option:eq(0)").prop("selected",!0),$("#select_cantidad").selectmenu("refresh"),$bar_cod=a,$("#nomb_prod_unidades").html($nombre_prod),$("#dialog_confirm_unidades").dialog({width:480,resizable:!1,show:{effect:"blind",pieces:8,duration:10},title:"Agregar Sucursal",close:function(a,b){},buttons:{Cancelar:function(){$(this).dialog("close"),limpiar_datos_insert()},Aceptar:function(){$("#btn_convertir_unidades").trigger("click"),$(this).dialog("close"),$("#select_cantidad option:eq(0)").prop("selected",!0),$("#select_cantidad").selectmenu("refresh"),limpiar_datos_insert()}}})}"no_existe"==c.status&&$("#text_nombre_prod").html('<div class="msg alerta_err">Producto no existente</div>'),"codigo_unidades_no_disponible"==c.status&&(""!=c.codigo_unidades?$("#text_nombre_prod").html('<div class="msg alerta_err">El producto con codigo: <strong>'+c.codigo_unidades+"</strong> asociado a <strong>"+c.nombre+"</strong> no esta disponible.</div>"):$("#text_nombre_prod").html('<div class="msg alerta_err">Este producto no tiene asociado un codigo de producto para convertirlo a unidades.</div>')),"codigo_unidades_no_existe"==c.status&&$("#text_nombre_prod").html('<div class="msg alerta_err">El producto con codigo: '+c.codigo_unidades+" no existe.</div>"),"error_sql"==c.status&&$("#text_nombre_prod").html('<div class="msg alerta_err">Problemas con el SQL</div>')},timeout:9e4,error:function(){$("#ajax_respuesta").html('<div class="msg alerta_err">Problemas con el Servidor</div>')}}))}var $prod_existente=0,$cantidad_org=0,$nombre_codigo_unidades="",$cantidad_total_unidades=0,$nombre_prod="",$eq=-1,$bar_cod="";$(document).ready(function(a){$("#btn_convertir_unidades").hide(),$("#txt_cj_codigo").focus(),altura=$(window).height(),$("#btn_convertir_unidades").button({text:!0,icons:{primary:"ui-icon-plusthick"}}).click(function(a){return 0==$prod_existente?void $("#text_nombre_prod").html('<div class="msg alerta_err">Los datos no son correctos.</div>'):($cantidad=$("#select_cantidad").val(),$cantidad_total_unidades=parseInt($cantidad_total_unidades)+parseInt($cantidad),$id_prod=$("#text_nombre_prod").attr("id_prod"),$id_codigo_unidades=$("#text_nombre_prod").attr("id_codigo_unidades"),$txt_sucursal=$("#lst_sucursales_admin_prod option:selected").text(),void $.ajax({type:"POST",contentType:"application/x-www-form-urlencoded",url:"crud_pventas.php",data:"accion=producto_a_unidades_update&id_prod="+$id_prod+"&id_codigo_unidades="+$id_codigo_unidades+"&cantidad="+$cantidad+"&nombre_prod_1="+$nombre_prod+"&nombre_prod_2="+$nombre_codigo_unidades,beforeSend:function(){},success:function(a){var b=jQuery.parseJSON(a);"ok_update"==b.status&&($("#ajax_respuesta_insert").prepend('<div class="msg alerta_ok">Cantidad Agregada Correctamente. ('+$txt_sucursal+")<br><strong>Total:</strong> "+$cantidad_total_unidades+" - "+$nombre_codigo_unidades+"</div>"),$("#select_cantidad option:eq(0)").prop("selected",!0),$("#select_cantidad").selectmenu("refresh"),limpiar_datos_insert()),"no_update"==b.tipo&&$("#ajax_respuesta_insert").prepend('<div class="msg alerta_err">Problemas con el Servidor</div>')},timeout:9e4,error:function(){$("#ajax_respuesta_insert").prepend('<div class="msg alerta_ok">Problemas con el servidor intente de nuevo.</div>')}}))}),$("#lst_sucursales_admin_prod").selectmenu({change:function(a,b){limpiar_datos_insert(),""==$id_sucursal}}),$("#select_cantidad").selectmenu({})});